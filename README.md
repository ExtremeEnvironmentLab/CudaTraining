# 液态氩分子动力学模拟 - CUDA加速版本

这个项目是一个使用CUDA加速的分子动力学模拟程序，用于模拟液态氩的行为。该程序基于原始的CPU版本（ConsoleApplicationMD3.cpp）进行了CUDA并行化改造，以提高计算效率。

## 功能概述

该程序实现了以下功能：

1. 使用Verlet积分方法进行分子动力学模拟
2. 采用动态近邻表方法优化力的计算
3. 模拟液态氩在特定温度和密度下的行为
4. 使用CUDA并行计算加速模拟过程

## 主要优化点

相比原始的CPU版本，CUDA版本主要进行了以下优化：

1. **数据结构重组**：将原始的二维数组重构为一维数组，以适应CUDA内存模型
2. **并行计算加速**：
   - 使用CUDA核函数并行计算粒子间的力
   - 并行执行Verlet积分的位置和速度更新
3. **内存管理优化**：
   - 实现了主机和设备之间的高效数据传输
   - 动态管理近邻表的设备内存

## 文件说明

- `ConsoleApplicationMD3_CUDA.cu`：CUDA加速版本的主程序
- `T3_CUDA.data`：模拟结果输出文件，记录每个时间步的温度

## 编译与运行

### 系统要求

- CUDA工具包（建议CUDA 10.0或更高版本）
- 支持CUDA的NVIDIA GPU
- C++编译器（如Visual Studio、GCC等）

### 编译命令

使用NVIDIA的NVCC编译器编译：

```bash
nvcc -O3 ConsoleApplicationMD3_CUDA.cu -o md_cuda
```

### 运行程序

```bash
./md_cuda
```

运行后，程序将生成`T3_CUDA.data`文件，其中包含模拟过程中每个时间步的温度数据。

## 性能对比

CUDA加速版本相比原始CPU版本，在处理大规模粒子系统时可以获得显著的性能提升。具体加速比取决于GPU硬件和粒子数量。

## 算法说明

1. **初始化**：在面心立方晶格中放置氩原子，并赋予符合指定温度的初始速度
2. **近邻表构建**：建立粒子对的近邻表，仅考虑距离小于截断半径的粒子对
3. **力计算**：使用CUDA并行计算粒子间的Lennard-Jones力
4. **积分**：使用Velocity Verlet方法并行更新粒子的位置和速度
5. **温度控制**：定期重新调整粒子速度以维持指定温度

## 注意事项

- 程序中使用了原子操作（atomicAdd）来避免并行计算中的数据竞争
- 为了获得最佳性能，可以根据具体GPU调整线程块大小（blockSize） 